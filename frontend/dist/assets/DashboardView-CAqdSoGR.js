import{h as M,k as T,l as d,w as r,r as w,o as a,a as t,t as i,u as f,b as n,R as S,g as C,c as l,F as _,m as x,d as v,i as p}from"./index-B2-RunWW.js";import{u as j,A}from"./AppShell-CflNe7-M.js";import{_ as c}from"./WowCard-Cmy-HL6C.js";import{_ as E}from"./WowButton-B3DY_ja0.js";import{_ as D}from"./StatusBadge-iRNFSn9z.js";import{_ as L,a as F}from"./RealmBadge-CFQI9HTC.js";import{_ as I}from"./ClassBadge-CR9v84wO.js";import{u as U}from"./calendar-Desxczv1.js";import{u as W}from"./useWowIcons-CHrwIOWq.js";import"./events-CGIxMRf0.js";const H={class:"p-4 md:p-6 space-y-6"},q={class:"flex items-center justify-between"},J={class:"text-text-muted text-sm mt-0.5"},K={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},O={key:1,class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},P={class:"text-3xl font-bold text-accent-gold"},Q={class:"text-3xl font-bold text-green-400"},X={class:"text-3xl font-bold text-yellow-400"},Y={class:"text-3xl font-bold text-red-400"},Z={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},tt={class:"lg:col-span-2 space-y-3"},et={key:0,class:"space-y-2"},st={key:1,class:"text-center py-8 text-text-muted"},at={class:"flex items-center gap-4"},ot=["src","alt"],lt={class:"flex-1 min-w-0"},rt={class:"flex items-center gap-2 flex-wrap"},nt={class:"font-semibold text-text-primary"},it={class:"text-sm text-text-muted mt-1"},dt={class:"space-y-3"},ct={key:0,class:"space-y-2"},ut={key:1,class:"text-center py-8 text-text-muted text-sm"},mt={class:"flex items-center gap-2"},_t={class:"text-sm text-text-primary flex-1 truncate"},Ct={__name:"DashboardView",setup(xt){const R=M(),h=j(),y=U(),{getRaidIcon:V}=W(),u=w(!0),m=w([]);T(async()=>{u.value=!0;try{await h.fetchGuilds(),h.currentGuild&&await y.fetchEvents(h.currentGuild.id)}finally{u.value=!1}});const B=new Date,g=p(()=>y.events.filter(o=>new Date(o.start_time??o.date)>=B&&o.status!=="cancelled").sort((o,s)=>new Date(o.start_time??o.date)-new Date(s.start_time??s.date)).slice(0,8)),N=p(()=>m.value.filter(o=>o.status==="going").length),$=p(()=>m.value.filter(o=>o.status==="tentative").length),G=p(()=>g.value.length-m.value.length);function z(o){return o?new Date(o).toLocaleString("en-GB",{weekday:"short",day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"?"}return(o,s)=>(a(),d(A,null,{default:r(()=>{var k;return[t("div",H,[t("div",q,[t("div",null,[s[0]||(s[0]=t("h1",{class:"wow-heading text-2xl"},"Dashboard",-1)),t("p",J,"Welcome back, "+i((k=f(R).user)==null?void 0:k.username)+"!",1)]),n(f(S),{to:"/calendar"},{default:r(()=>[n(E,{variant:"secondary"},{default:r(()=>[...s[1]||(s[1]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),C(" Calendar ",-1)])]),_:1})]),_:1})]),u.value?(a(),l("div",K,[(a(),l(_,null,x(4,e=>t("div",{key:e,class:"h-24 rounded-lg bg-bg-secondary border border-border-default loading-pulse"})),64))])):(a(),l("div",O,[n(c,{class:"text-center"},{default:r(()=>[t("div",P,i(g.value.length),1),s[2]||(s[2]=t("div",{class:"text-xs text-text-muted mt-1"},"Upcoming Raids",-1))]),_:1}),n(c,{class:"text-center"},{default:r(()=>[t("div",Q,i(N.value),1),s[3]||(s[3]=t("div",{class:"text-xs text-text-muted mt-1"},"Confirmed",-1))]),_:1}),n(c,{class:"text-center"},{default:r(()=>[t("div",X,i($.value),1),s[4]||(s[4]=t("div",{class:"text-xs text-text-muted mt-1"},"Tentative",-1))]),_:1}),n(c,{class:"text-center"},{default:r(()=>[t("div",Y,i(G.value),1),s[5]||(s[5]=t("div",{class:"text-xs text-text-muted mt-1"},"No Response",-1))]),_:1})])),t("div",Z,[t("div",tt,[s[7]||(s[7]=t("h2",{class:"wow-heading text-lg"},"Upcoming Raids",-1)),u.value?(a(),l("div",et,[(a(),l(_,null,x(3,e=>t("div",{key:e,class:"h-16 rounded bg-bg-secondary border border-border-default loading-pulse"})),64))])):g.value.length===0?(a(),l("div",st," No upcoming raids scheduled. ")):(a(!0),l(_,{key:2},x(g.value,e=>(a(),d(f(S),{key:e.id,to:`/raids/${e.id}`,class:"block"},{default:r(()=>[n(c,{class:"hover:border-border-gold transition-colors cursor-pointer"},{default:r(()=>[t("div",at,[t("img",{src:f(V)(e.raid_type),alt:e.raid_type,class:"w-12 h-12 rounded border border-border-default flex-shrink-0"},null,8,ot),t("div",lt,[t("div",rt,[t("span",nt,i(e.title),1),e.size?(a(),d(L,{key:0,size:e.size},null,8,["size"])):v("",!0),n(D,{status:e.status??"open"},null,8,["status"])]),t("div",it,[C(i(z(e.start_time??e.date))+" ",1),e.realm?(a(),d(F,{key:0,realm:e.realm,class:"ml-2"},null,8,["realm"])):v("",!0)])]),s[6]||(s[6]=t("svg",{class:"w-5 h-5 text-text-muted flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])]),_:2},1024)]),_:2},1032,["to"]))),128))]),t("div",dt,[s[8]||(s[8]=t("h2",{class:"wow-heading text-lg"},"My Signups",-1)),u.value?(a(),l("div",ct,[(a(),l(_,null,x(3,e=>t("div",{key:e,class:"h-14 rounded bg-bg-secondary border border-border-default loading-pulse"})),64))])):m.value.length===0?(a(),l("div",ut," No signups yet. ")):(a(!0),l(_,{key:2},x(m.value,e=>(a(),d(c,{key:e.id,class:"py-2"},{default:r(()=>{var b;return[t("div",mt,[(b=e.character)!=null&&b.class?(a(),d(I,{key:0,"class-name":e.character.class},null,8,["class-name"])):v("",!0),t("span",_t,i(e.event_title??"Raid"),1),n(D,{status:e.status},null,8,["status"])])]}),_:2},1024))),128))])])])]}),_:1}))}};export{Ct as default};
