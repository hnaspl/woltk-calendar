import{x as z,k as O,l as V,w as a,r as d,o as r,a as t,b as n,g as u,c as x,F as T,m as U,t as m,u as P,d as N,e as L,f as c,v as D,z as M,A as W}from"./index-B2-RunWW.js";import{u as h,a as J,A as K}from"./AppShell-CflNe7-M.js";import{_ as Q}from"./WowCard-Cmy-HL6C.js";import{_ as g}from"./WowButton-B3DY_ja0.js";import{_ as G}from"./WowModal-CCoTxtnT.js";import{_ as X,a as Y}from"./RealmBadge-CFQI9HTC.js";import{u as Z}from"./useWowIcons-CHrwIOWq.js";const ee=v=>z.get(`/guilds/${v}/raid-definitions`),te=(v,i)=>z.post(`/guilds/${v}/raid-definitions`,i),le=(v,i,k)=>z.put(`/guilds/${v}/raid-definitions/${i}`,k),se=(v,i)=>z.delete(`/guilds/${v}/raid-definitions/${i}`),oe={class:"p-4 md:p-6 space-y-6"},ae={class:"flex items-center justify-between"},ie={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},re={key:1,class:"p-4 rounded-lg bg-red-900/30 border border-red-600 text-red-300"},de={key:2,class:"text-center py-12 text-text-muted"},ne={key:3,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},ue={class:"flex items-start gap-3 mb-3"},me=["src","alt"],ve={class:"flex-1 min-w-0"},be={class:"font-bold text-text-primary truncate"},pe={class:"flex items-center gap-1.5 mt-1"},xe={class:"grid grid-cols-3 gap-2 text-center text-xs mb-4"},fe={class:"bg-blue-500/10 rounded p-1.5"},ce={class:"text-blue-300 font-bold"},ge={class:"bg-green-500/10 rounded p-1.5"},ye={class:"text-green-300 font-bold"},_e={class:"bg-red-500/10 rounded p-1.5"},ke={class:"text-red-300 font-bold"},we={class:"flex gap-2"},De={class:"grid grid-cols-2 gap-4"},Ce=["value"],Se={class:"grid grid-cols-3 gap-3"},Ve={key:0,class:"p-3 rounded bg-red-900/30 border border-red-600 text-red-300 text-sm"},ze={class:"flex justify-end gap-3"},$e={class:"text-text-muted"},Re={class:"text-text-primary"},Te={class:"flex justify-end gap-3"},Ae={__name:"RaidDefinitionsView",setup(v){const i=h(),k=J(),{getRaidIcon:j}=Z(),b=d([]),$=d(!0),y=d(!1),R=d(null),f=d(null),_=d(!1),w=d(!1),p=d(null),C=d(null),I=[{value:"naxx",label:"Naxxramas"},{value:"os",label:"Obsidian Sanctum"},{value:"eoe",label:"Eye of Eternity"},{value:"voa",label:"Vault of Archavon"},{value:"ulduar",label:"Ulduar"},{value:"toc",label:"Trial of the Crusader"},{value:"icc",label:"Icecrown Citadel"},{value:"rs",label:"Ruby Sanctum"}],s=W({name:"",raid_type:"",size:"",realm:"",tank_slots:2,healer_slots:5,dps_slots:18});O(async()=>{$.value=!0,i.currentGuild||await i.fetchGuilds();try{b.value=await ee(i.currentGuild.id)}catch{R.value="Failed to load raid definitions"}finally{$.value=!1}});function A(){p.value=null,Object.assign(s,{name:"",raid_type:"",size:"",realm:"",tank_slots:2,healer_slots:5,dps_slots:18}),f.value=null,_.value=!0}function B(o){p.value=o,Object.assign(s,{name:o.name,raid_type:o.raid_type,size:o.size,realm:o.realm??"",tank_slots:o.tank_slots??2,healer_slots:o.healer_slots??5,dps_slots:o.dps_slots??18}),f.value=null,_.value=!0}function F(o){C.value=o,w.value=!0}async function E(){var o,e;if(f.value=null,!s.name||!s.raid_type||!s.size){f.value="Name, type and size are required";return}y.value=!0;try{if(p.value){const l=await le(i.currentGuild.id,p.value.id,s),S=b.value.findIndex(H=>H.id===p.value.id);S!==-1&&(b.value[S]=l)}else b.value.push(await te(i.currentGuild.id,s));_.value=!1,k.showToast(p.value?"Definition updated":"Definition created","success")}catch(l){f.value=((e=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:e.message)??"Failed to save"}finally{y.value=!1}}async function q(){y.value=!0;try{await se(i.currentGuild.id,C.value.id),b.value=b.value.filter(o=>o.id!==C.value.id),w.value=!1,k.showToast("Definition deleted","success")}catch{k.showToast("Failed to delete","error")}finally{y.value=!1}}return(o,e)=>(r(),V(K,null,{default:a(()=>[t("div",oe,[t("div",ae,[e[12]||(e[12]=t("h1",{class:"wow-heading text-2xl"},"Raid Definitions",-1)),n(g,{onClick:A},{default:a(()=>[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" New Definition ",-1)])]),_:1})]),$.value?(r(),x("div",ie,[(r(),x(T,null,U(4,l=>t("div",{key:l,class:"h-32 rounded-lg bg-bg-secondary border border-border-default loading-pulse"})),64))])):R.value?(r(),x("div",re,m(R.value),1)):b.value.length===0?(r(),x("div",de," No raid definitions yet. Create one to start scheduling raids. ")):(r(),x("div",ne,[(r(!0),x(T,null,U(b.value,l=>(r(),V(Q,{key:l.id},{default:a(()=>[t("div",ue,[t("img",{src:P(j)(l.raid_type),alt:l.raid_type,class:"w-12 h-12 rounded border border-border-default flex-shrink-0"},null,8,me),t("div",ve,[t("div",be,m(l.name),1),t("div",pe,[l.size?(r(),V(X,{key:0,size:l.size},null,8,["size"])):N("",!0),l.realm?(r(),V(Y,{key:1,realm:l.realm},null,8,["realm"])):N("",!0)])])]),t("div",xe,[t("div",fe,[t("div",ce,m(l.tank_slots??2),1),e[13]||(e[13]=t("div",{class:"text-text-muted"},"Tanks",-1))]),t("div",ge,[t("div",ye,m(l.healer_slots??5),1),e[14]||(e[14]=t("div",{class:"text-text-muted"},"Healers",-1))]),t("div",_e,[t("div",ke,m(l.dps_slots??18),1),e[15]||(e[15]=t("div",{class:"text-text-muted"},"DPS",-1))])]),t("div",we,[n(g,{variant:"secondary",class:"flex-1 text-xs py-1.5",onClick:S=>B(l)},{default:a(()=>[...e[16]||(e[16]=[u("Edit",-1)])]),_:1},8,["onClick"]),n(g,{variant:"danger",class:"text-xs py-1.5 px-3",onClick:S=>F(l)},{default:a(()=>[...e[17]||(e[17]=[u("✕",-1)])]),_:1},8,["onClick"])])]),_:2},1024))),128))]))]),n(G,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>_.value=l),title:p.value?"Edit Raid Definition":"New Raid Definition",size:"md"},{footer:a(()=>[t("div",ze,[n(g,{variant:"secondary",onClick:e[7]||(e[7]=l=>_.value=!1)},{default:a(()=>[...e[27]||(e[27]=[u("Cancel",-1)])]),_:1}),n(g,{loading:y.value,onClick:E},{default:a(()=>[u(m(p.value?"Save":"Create"),1)]),_:1},8,["loading"])])]),default:a(()=>[t("form",{onSubmit:L(E,["prevent"]),class:"space-y-4"},[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-xs text-text-muted mb-1"},"Name *",-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.name=l),required:"",placeholder:"ICC 25 Heroic",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},null,512),[[D,s.name]])]),t("div",De,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-xs text-text-muted mb-1"},"Raid Type *",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.raid_type=l),required:"",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},[e[19]||(e[19]=t("option",{value:""},"Select…",-1)),(r(),x(T,null,U(I,l=>t("option",{key:l.value,value:l.value},m(l.label),9,Ce)),64))],512),[[M,s.raid_type]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-xs text-text-muted mb-1"},"Size *",-1)),c(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.size=l),required:"",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},[...e[21]||(e[21]=[t("option",{value:""},"Select…",-1),t("option",{value:10},"10-man",-1),t("option",{value:25},"25-man",-1)])],512),[[M,s.size,void 0,{number:!0}]])])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-xs text-text-muted mb-1"},"Realm",-1)),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.realm=l),placeholder:"Icecrown",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},null,512),[[D,s.realm]])]),t("div",Se,[t("div",null,[e[24]||(e[24]=t("label",{class:"block text-xs text-text-muted mb-1"},"Tank Slots",-1)),c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.tank_slots=l),type:"number",min:"1",max:"10",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},null,512),[[D,s.tank_slots,void 0,{number:!0}]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-xs text-text-muted mb-1"},"Healer Slots",-1)),c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.healer_slots=l),type:"number",min:"1",max:"15",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},null,512),[[D,s.healer_slots,void 0,{number:!0}]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-xs text-text-muted mb-1"},"DPS Slots",-1)),c(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.dps_slots=l),type:"number",min:"1",max:"30",class:"w-full bg-bg-tertiary border border-border-default text-text-primary rounded px-3 py-2 text-sm focus:border-border-gold outline-none"},null,512),[[D,s.dps_slots,void 0,{number:!0}]])])]),f.value?(r(),x("div",Ve,m(f.value),1)):N("",!0)],32)]),_:1},8,["modelValue","title"]),n(G,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=l=>w.value=l),title:"Delete Definition",size:"sm"},{footer:a(()=>[t("div",Te,[n(g,{variant:"secondary",onClick:e[9]||(e[9]=l=>w.value=!1)},{default:a(()=>[...e[30]||(e[30]=[u("Cancel",-1)])]),_:1}),n(g,{variant:"danger",loading:y.value,onClick:q},{default:a(()=>[...e[31]||(e[31]=[u("Delete",-1)])]),_:1},8,["loading"])])]),default:a(()=>{var l;return[t("p",$e,[e[28]||(e[28]=u("Delete ",-1)),t("strong",Re,m((l=C.value)==null?void 0:l.name),1),e[29]||(e[29]=u("? Events using this definition won't be affected.",-1))])]}),_:1},8,["modelValue"])]),_:1}))}};export{Ae as default};
